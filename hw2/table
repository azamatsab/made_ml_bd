CREATE TABLE artists (mbid VARCHAR(100), artist_mb VARCHAR(100), artist_lastfm VARCHAR(200), country_mb VARCHAR(100), country_lastfm VARCHAR(100), tags_mb VARCHAR(300), tags_lastfm VARCHAR(300), listeners_lastfm INT, scrobbles_lastfm INT, ambiguous_artist BOOLEAN) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',';

LOAD DATA LOCAL INPATH "artists.csv" OVERWRITE INTO TABLE artists;

1. SELECT t.artist_lastfm FROM (SELECT artist_lastfm, scrobbles_lastfm FROM `default`.`artists` ORDER BY scrobbles_lastfm DESC LIMIT 1) t;
2. SELECT tags, sum(scrobbles_lastfm) as total FROM artists LATERAL VIEW explode(SPLIT(tags_lastfm, ";")) adTable AS tags GROUP BY tags ORDER BY total DESC LIMIT 1;
3. SELECT DISTINCT k.scrobbles_lastfm, k.artist_lastfm FROM 
    (SELECT f.tags, f.artist_lastfm, f.scrobbles_lastfm FROM 
        (SELECT tags, artist_lastfm, scrobbles_lastfm 
            FROM artists LATERAL VIEW explode(SPLIT(tags_lastfm, ";")) intable AS tags) f WHERE f.tags in
    (SELECT g.tags FROM 
        (SELECT t.tags, sum(scrobbles_lastfm) as total FROM 
            (SELECT tags, artist_lastfm, scrobbles_lastfm FROM artists LATERAL VIEW explode(SPLIT(tags_lastfm, ";")) intable AS tags) t 
                GROUP BY t.tags ORDER BY total DESC LIMIT 10) g)) k ORDER BY k.scrobbles_lastfm DESC;
4. SELECT t.artist_lastfm FROM (SELECT artist_lastfm, listeners_lastfm FROM `default`.`artists` ORDER BY listeners_lastfm DESC LIMIT 1) t;
